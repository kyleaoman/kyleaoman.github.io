name: refresh-calendar-access

on:
  schedule:
    - cron: '19 3 * * 0-6'
  workflow_dispatch:

jobs:
  refresh-calendar-access:
    runs-on: ubuntu-latest
    env: 
      CI_COMMIT_MESSAGE: Update calendar embedding info.
      CI_COMMIT_AUTHOR: Calendar Bot
    steps:
    - uses: 'actions/checkout@v4'
    - uses: 'actions/setup-python@v4'
      with:
        python-version: '3.11'
    - name: 'Refresh calendar access'
      run: |
        pip install --upgrade pip
        pip install --upgrade requests
        python refresh_calendar.py
        git config --global user.name "${{ env.CI_COMMIT_AUTHOR }}"
        git config --global user.email "kyleaoman@users.noreply.github.com"
        git commit -a -m "${{ env.CI_COMMIT_MESSAGE }}"
        git push
